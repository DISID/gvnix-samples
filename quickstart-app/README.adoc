= gvNIX quick start application
Getting started with gvNIX
:page-layout: base
:toc-placement: manual
:homepage: http://gvnix.org
:download: http://code.google.com/p/gvnix/
:installguide: http://code.google.com/p/gvnix/wiki/InstallGvnix
:download: http://code.google.com/p/gvnix/downloads/

gvNIX is a Spring Roo distribution that focuses both enterprise knowledge and 
enterprise standards to build Java applications.

You must {download}[download], unpack and {installguide}[install] the 
development environment for gvNIX 1.3+, to be able to follow this guide.

The goal of this quick start guide is to familiarize you with gvNIX. For this 
purpose, we will build an application following a _domain-driven design_
philosophy:

* Start with domain model (entities and logic) that captures the problem domain
  of the system being built.
* Start without a service layer initially and only add services where the 
  logic doesn't belong in any domain entity.
* Use _Design by Contract_ (DbC), _Automated Tests_, _CI_ and _Refactoring_ to 
  make the implementation as closely aligned as possible with the domain model.

The application presented in this guide is the Spring PetClinic application. The users of the application are employees of the clinic who, in the course of their work, need to view and manage information regarding veterinarians, the clients, and their pets.

Note this sample isn't a real application which normally needs additional work
like UI customization, performance improvement, database queries tunning, etc.

This guide teaches you how to:

. <<create-a-new-project, Create a new project>>
. <<persistence-setup, Persistence Setup>>
. <<build-the-domain-model, Build the domain model>>
. <<add-finders, Add finder methods>>
. <<add-web-layers, Add web layers>>
. <<add-occ, Add Optimistic Concurrency Control >>
. <<add-tests, Add JUnit & Selenium Tests >>
. <<jquery-setup, JQuery, Datatables & Bootstrap Setup >>
. <<menu-setup, Menu Setup >>
. <<add-datatables, Create Patterns & Details using Datatables>>
. <<enable-inline-editing, Enable Datatables Inline Editing >>
. <<add-spring-security, Add Spring Security >>
. <<add-reports, Add Reports >>
. <<add-web-services, Add WebServices >>

[[create-a-new-project]]
== Create a new project

. Create a directory for the new project.
+

[source,shell]
$ mkdir clinic
$ cd clinic

. Start gvNIX
. Execute command to create project:
+

[source,shell]
project --topLevelPackage com.springsource.petclinic --projectName petclinic

[[persistence-setup]]
== Persistence Setup

Execute the following command to set up persistence in your gvNIX project (Replace provider param and database param with your own configuration):

[source,shell]
jpa setup --provider HIBERNATE --database HYPERSONIC_PERSISTENT

[[build-the-domain-model]]
== Build the domain model

=== The domain model

image:images/petclinic-uml.png[Pet Clinic Domain Entities]

This class diagram represents a simplified model of the problem domain for the
pet clinic problem domain, it is a good starting point for the application 
in order to deliver a first prototype.

=== Create the domain entities

Following the above class diagram, run the following commands to generate the petclinic domain entities:

. Create entities:
+

[source,shell]
entity jpa --class ~.domain.Pet --sequenceName PET_SEQ
entity jpa --class ~.domain.Visit --sequenceName VISIT_SEQ
entity jpa --class ~.domain.AbstractPerson --abstract
entity jpa --class ~.domain.Vet --extends ~.domain.AbstractPerson
entity jpa --class ~.domain.Owner --extends ~.domain.AbstractPerson

. Create general enumerates to use in petclinic application:
+

[source,shell]
enum type --class ~.reference.PetType
enum constant --name Dog
enum constant --name Cat
enum constant --name Bird
enum type --class ~.reference.Specialty
enum constant --name Cardiology
enum constant --name Dentistry
enum constant --name Nutrition

. Add fields to entities (you must to indicate field type, field name and the entity class):
+

[source,shell]
field string --fieldName firstName --sizeMin 3 --sizeMax 30 --class ~.domain.AbstractPerson
field string --fieldName lastName --notNull --sizeMin 3 --sizeMax 30
field string --fieldName address --notNull --sizeMax 50 --sizeMin 1
field string --fieldName city --notNull --sizeMax 30
field string --fieldName telephone --notNull
field string --fieldName homePage --sizeMax 30
field string --fieldName email --sizeMax 30 --sizeMin 6
field date --fieldName birthDay --type java.util.Date --notNull
field string --fieldName description --sizeMax 255 --class ~.domain.Visit
field date --fieldName visitDate --type java.util.Date --notNull --past
field reference --fieldName pet --type ~.domain.Pet --notNull
field reference --fieldName vet --type ~.domain.Vet
field boolean --fieldName sendReminders --notNull --primitive --class ~.domain.Pet
field string --fieldName name --notNull --sizeMin 1
field number --fieldName weight --type java.lang.Float --notNull --min 0
field reference --fieldName owner --type ~.domain.Owner
field enum --fieldName type --type ~.reference.PetType --notNull
field date --fieldName employedSince --type java.util.Calendar --notNull --past --class ~.domain.Vet
field enum --fieldName specialty --type ~.reference.Specialty --notNull false
field set --class ~.domain.Owner --fieldName pets --type ~.domain.Pet --mappedBy owner --notNull false --cardinality ONE_TO_MANY
field set --class ~.domain.Vet --fieldName visits --type ~.domain.Visit --mappedBy vet --notNull false --cardinality ONE_TO_MANY
field reference --fieldName owner --type ~.domain.Owner --class ~.domain.Vet
field set --fieldName vets --type ~.domain.Vet --class ~.domain.Owner --cardinality ONE_TO_MANY --mappedBy owner
field set --fieldName visits --type ~.domain.Visit --class ~.domain.Pet --cardinality ONE_TO_MANY --mappedBy pet


[[add-finders]]
== Add finder methods

If you want to find data by different fields in your entities, you need to generate some methods. Execute the following commands in gvNIX shell to implements this functionality (you must to indicate unic finderName and entity class):

[source,shell]
finder add --finderName findPetsByNameAndWeight --class ~.domain.Pet
finder add --finderName findPetsByOwner
finder add --finderName findPetsBySendRemindersAndWeightLessThan
finder add --finderName findPetsByTypeAndNameLike
finder add --finderName findVisitsByDescriptionAndVisitDate --class ~.domain.Visit
finder add --finderName findVisitsByVisitDateBetween
finder add --finderName findVisitsByDescriptionLike

[[add-web-layers]]
== Add Web Layers


